module.exports=[56704,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},20635,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/action-async-storage.external.js",()=>require("next/dist/server/app-render/action-async-storage.external.js"))},32319,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},24361,(a,b,c)=>{b.exports=a.x("util",()=>require("util"))},14747,(a,b,c)=>{b.exports=a.x("path",()=>require("path"))},9270,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.AppRouterContext},36313,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.HooksClientContext},18341,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.ServerInsertedHtml},38783,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].ReactServerDOMTurbopackClient},65066,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(23700),e=a.i(20331);a.i(69387);var f=a.i(60574);a.i(30485);var g=a.i(31052),h=a.i(50944),i=a.i(38246);a.i(60121);var j=a.i(5420);let k="https://firebasestorage.googleapis.com/v0/b/brillianse-801f7.firebasestorage.app/o/logos%2FBrillianse%20(5)%20copy.png?alt=media&token=ecffd21e-dff9-4151-b57f-5515be4c87e7";function l(){let[a,l]=(0,c.useState)(null),[m,n]=(0,c.useState)(!0),[o,p]=(0,c.useState)(null),[q,r]=(0,c.useState)(null),[s,t]=(0,c.useState)(null),[u,v]=(0,c.useState)(!0),[w,x]=(0,c.useState)(!1),[y,z]=(0,c.useState)(!1),[A,B]=(0,c.useState)({name:"",username:"",twitter:"",linkedin:"",instagram:""}),[C,D]=(0,c.useState)(null),[E,F]=(0,c.useState)(null),[G,H]=(0,c.useState)(null),[I,J]=(0,c.useState)(!1),[K,L]=(0,c.useState)(0),[M,N]=(0,c.useState)(!1),O=(0,h.useRouter)();(0,c.useEffect)(()=>{let a=(0,g.onAuthStateChanged)(e.auth,async a=>{if(a){await a.reload(),l(a),v(a.emailVerified);let b=(0,f.doc)(e.db,"users",a.uid),c=await (0,f.getDoc)(b);if(c.exists()){let b=c.data();N(b.isProfileComplete||!1);let d=b.username||"";if(!b.isProfileComplete&&!d){let b=a.email?.split("@")[0].replace(/[^a-zA-Z0-9]/g,"").toLowerCase()||"user";try{let a=(0,f.query)((0,f.collection)(e.db,"users"),(0,f.where)("username","==",b));d=(await (0,f.getDocs)(a)).empty?b:`${b}${Math.floor(100+900*Math.random())}`}catch(a){d=`${b}${Math.floor(100+900*Math.random())}`}}B({name:b.name||"",username:d,twitter:b.socials?.twitter||"",linkedin:b.socials?.linkedin||"",instagram:b.socials?.instagram||""}),F(b.profilePictureUrl||null),b.dailyGroup?.groupId&&D(b.dailyGroup.groupId)}}else O.push("/");n(!1)});return()=>a()},[O]),(0,c.useEffect)(()=>{if(!a||u)return;let b=setInterval(async()=>{await a.reload(),a.emailVerified&&(v(!0),clearInterval(b))},3e3);return()=>clearInterval(b)},[a,u]);let P=a=>{let{id:b,value:c}=a.target,d=c;"username"===b&&(d=c.toLowerCase().replace(/\s/g,"")),B(a=>({...a,[b]:d}))},Q=async b=>{if(b.preventDefault(),!a)return;p(null),t(null),r(null);let{name:c,username:d,twitter:g,linkedin:h,instagram:i}=A;if(!c.trim())return void r("Name is required.");if(!d.trim())return void r("Username is required.");if(!g&&!h&&!i)return void r("Please add at least one social media handle.");try{let b=(0,f.doc)(e.db,"users",a.uid),k=await (0,f.getDoc)(b);if((k.exists()?k.data().username:null)!==d){let a=(0,f.query)((0,f.collection)(e.db,"users"),(0,f.where)("username","==",d));if(!(await (0,f.getDocs)(a)).empty)return void r("Username is already taken. Please try again.")}let l=E;if(G){J(!0);let b=(0,j.ref)(e.storage,`profile_pictures/${a.uid}`),c=(0,j.uploadBytesResumable)(b,G);await new Promise((a,b)=>{c.on("state_changed",a=>{let b=a.bytesTransferred/a.totalBytes*100;L(b)},a=>{console.error("Upload failed:",a),p("Image upload failed. Please try again."),b(a)},async()=>{l=await (0,j.getDownloadURL)(c.snapshot.ref),J(!1),H(null),a()})})}await (0,f.setDoc)(b,{name:c,username:d,email:a.email,socials:{twitter:g,linkedin:h,instagram:i},profilePictureUrl:l,isProfileComplete:!0},{merge:!0}),t("Profile saved! Redirecting to your group..."),setTimeout(()=>{C?O.push(`/group/${C}`):O.push("/")},2e3)}catch(a){I||(console.error(a),p("Failed to save profile. Please try again."))}finally{J(!1)}},R=async()=>{if(a)try{await (0,g.sendEmailVerification)(a),x(!0),setTimeout(()=>x(!1),3e3)}catch(a){console.error("Failed to resend verification:",a)}},S=async()=>{try{await (0,g.signOut)(e.auth),z(!1)}catch(a){console.error("Failed to sign out:",a)}};return m?(0,b.jsx)("main",{className:"loading-container",children:"Loading profile..."}):(0,b.jsxs)("main",{children:[(0,b.jsx)(d.default,{children:(0,b.jsx)("title",{children:"My Profile"})}),(0,b.jsxs)("div",{className:"profile-content-wrapper",children:[(0,b.jsx)("div",{className:"profile-nav-wrapper",children:C&&M&&(0,b.jsx)("div",{className:"page-nav-header",children:(0,b.jsx)(i.default,{href:`/group/${C}`,children:"←"})})}),(0,b.jsxs)("form",{onSubmit:Q,className:"profile-form",children:[(0,b.jsx)("h1",{children:"Your Profile"}),(0,b.jsx)("p",{children:"This is what other users in your group will see."}),s&&(0,b.jsx)("div",{className:"success-message",children:s}),o&&(0,b.jsx)("div",{className:"error-container",children:o}),q&&(0,b.jsx)("div",{className:"validation-error",children:q}),!u&&(0,b.jsxs)("div",{className:"verification-notice",children:[(0,b.jsx)("p",{children:"Please check your email to verify your account."}),(0,b.jsx)("button",{onClick:R,disabled:w,children:w?"Sent!":"Resend Email"})]}),(0,b.jsxs)("div",{className:"pfp-uploader",children:[(0,b.jsxs)("label",{htmlFor:"file-input",children:[(0,b.jsx)("img",{src:E||k,alt:"Profile",className:"pfp-preview",onError:a=>a.currentTarget.src=k}),(0,b.jsx)("span",{className:"pfp-edit-text",children:"Click to change"})]}),(0,b.jsx)("input",{id:"file-input",type:"file",accept:"image/png, image/jpeg",onChange:a=>{if(a.target.files&&a.target.files[0]){let b=a.target.files[0];H(b),F(URL.createObjectURL(b))}}})]}),I&&(0,b.jsx)("div",{className:"upload-progress-bar",children:(0,b.jsx)("div",{style:{width:`${K}%`}})}),(0,b.jsxs)("div",{className:"input-group",children:[(0,b.jsx)("label",{htmlFor:"name",children:"Name (Required)"}),(0,b.jsx)("input",{id:"name",type:"text",value:A.name,onChange:P,placeholder:"e.g. John Doe"})]}),(0,b.jsxs)("div",{className:"input-group",children:[(0,b.jsx)("label",{htmlFor:"username",children:"Username (Required)"}),(0,b.jsx)("input",{id:"username",type:"text",value:A.username,onChange:P,placeholder:"e.g. johndoe123"})]}),(0,b.jsxs)("div",{className:"input-group",children:[(0,b.jsx)("label",{htmlFor:"twitter",children:"X (Twitter) Handle"}),(0,b.jsx)("input",{id:"twitter",type:"text",value:A.twitter,onChange:P,placeholder:"e.g. @username"})]}),(0,b.jsxs)("div",{className:"input-group",children:[(0,b.jsx)("label",{htmlFor:"linkedin",children:"LinkedIn Profile"}),(0,b.jsx)("input",{id:"linkedin",type:"text",value:A.linkedin,onChange:P,placeholder:"e.g. linkedin.com/in/username"})]}),(0,b.jsxs)("div",{className:"input-group",children:[(0,b.jsx)("label",{htmlFor:"instagram",children:"Instagram Handle"}),(0,b.jsx)("input",{id:"instagram",type:"text",value:A.instagram,onChange:P,placeholder:"e.g. @username"})]}),(0,b.jsx)("button",{type:"submit",className:"btn-submit",disabled:I,children:I?`Uploading... ${K.toFixed(0)}%`:"Save Profile"})]}),(0,b.jsx)("div",{className:"profile-nav-wrapper",children:C&&M&&(0,b.jsx)("div",{className:"page-nav-header",style:{visibility:"hidden"},children:(0,b.jsx)(i.default,{href:`/group/${C}`,children:"←"})})})]}),(0,b.jsx)("button",{onClick:()=>{z(!0)},className:"btn-sign-out-profile",disabled:I,children:"Sign Out"}),y&&(0,b.jsx)("div",{className:"sign-out-modal-overlay",children:(0,b.jsxs)("div",{className:"sign-out-modal-content",children:[(0,b.jsx)("h2",{children:"Are you sure?"}),(0,b.jsx)("p",{children:"This will sign you out of your account."}),(0,b.jsxs)("div",{className:"modal-actions",children:[(0,b.jsx)("button",{onClick:S,className:"btn-danger",children:"Sign Out"}),(0,b.jsx)("button",{onClick:()=>z(!1),className:"btn-secondary",children:"Cancel"})]})]})})]})}a.s(["default",()=>l])}];

//# sourceMappingURL=%5Broot-of-the-server%5D__51915536._.js.map